import e from"react";const t="react-horizontal-scrolling-menu",n="-separator",o=`${t}-${n}`,r=`${t}--item`,l=`${t}--scroll-container`,i=`${t}--wrapper`,s=`${t}--inner-wrapper`,a=`${t}--header`,u=`${t}--arrow-left`,c=`${t}--arrow-right`,d=`${t}--footer`,v="itemId",m="data-key",f="data-index";var h=Object.freeze({__proto__:null,rootClassName:t,separatorString:n,separatorClassName:o,itemClassName:r,scrollContainerClassName:l,wrapperClassName:i,innerWrapperClassName:s,headerClassName:a,arrowLeftClassName:u,arrowRightClassName:c,footerClassName:d,id:v,dataKeyAttribute:m,dataIndexAttribute:f});function g({className:t="",children:n,onScroll:o=(()=>{}),scrollRef:r}){const i=e.useMemo((()=>`${l} ${t}`),[t]);return e.createElement("div",{className:i,onScroll:o,ref:r},n)}var p=e.memo((function({className:t,id:n,index:o,refs:r}){const l=e.useRef(null);return r[o]=l,e.createElement("div",{className:t,[m]:n,[f]:o,ref:l})}));var b=e.memo((function({children:t,className:n,id:o,index:r,refs:l}){const i=e.useRef(null);return l[String(r)]=i,e.createElement("div",{className:n,[m]:o,[f]:r,ref:i},t)}));const y=e=>"object"==typeof e&&null!=e&&1===e.nodeType,w=(e,t)=>(!t||"hidden"!==e)&&"visible"!==e&&"clip"!==e,E=(e,t)=>{if(e.clientHeight<e.scrollHeight||e.clientWidth<e.scrollWidth){const n=getComputedStyle(e,null);return w(n.overflowY,t)||w(n.overflowX,t)||(e=>{const t=(e=>{if(!e.ownerDocument||!e.ownerDocument.defaultView)return null;try{return e.ownerDocument.defaultView.frameElement}catch(e){return null}})(e);return!!t&&(t.clientHeight<e.scrollHeight||t.clientWidth<e.scrollWidth)})(e)}return!1},N=(e,t,n,o,r,l,i,s)=>l<e&&i>t||l>e&&i<t?0:l<=e&&s<=n||i>=t&&s>=n?l-e-o:i>t&&s<n||l<e&&s>n?i-t+r:0,C=e=>{const t=e.parentElement;return null==t?e.getRootNode().host||null:t},M=(e,t)=>{var n,o,r,l;if("undefined"==typeof document)return[];const{scrollMode:i,block:s,inline:a,boundary:u,skipOverflowHiddenElements:c}=t,d="function"==typeof u?u:e=>e!==u;if(!y(e))throw new TypeError("Invalid target");const v=document.scrollingElement||document.documentElement,m=[];let f=e;for(;y(f)&&d(f);){if(f=C(f),f===v){m.push(f);break}null!=f&&f===document.body&&E(f)&&!E(document.documentElement)||null!=f&&E(f,c)&&m.push(f)}const h=null!=(o=null==(n=window.visualViewport)?void 0:n.width)?o:innerWidth,g=null!=(l=null==(r=window.visualViewport)?void 0:r.height)?l:innerHeight,{scrollX:p,scrollY:b}=window,{height:w,width:M,top:I,right:S,bottom:x,left:$}=e.getBoundingClientRect(),{top:k,right:W,bottom:T,left:R}=(e=>{const t=window.getComputedStyle(e);return{top:parseFloat(t.scrollMarginTop)||0,right:parseFloat(t.scrollMarginRight)||0,bottom:parseFloat(t.scrollMarginBottom)||0,left:parseFloat(t.scrollMarginLeft)||0}})(e);let O="start"===s||"nearest"===s?I-k:"end"===s?x+T:I+w/2-k+T,A="center"===a?$+M/2-R+W:"end"===a?S+W:$-R;const V=[];for(let e=0;e<m.length;e++){const t=m[e],{height:n,width:o,top:r,right:l,bottom:u,left:c}=t.getBoundingClientRect();if("if-needed"===i&&I>=0&&$>=0&&x<=g&&S<=h&&I>=r&&x<=u&&$>=c&&S<=l)return V;const d=getComputedStyle(t),f=parseInt(d.borderLeftWidth,10),y=parseInt(d.borderTopWidth,10),E=parseInt(d.borderRightWidth,10),C=parseInt(d.borderBottomWidth,10);let k=0,W=0;const T="offsetWidth"in t?t.offsetWidth-t.clientWidth-f-E:0,R="offsetHeight"in t?t.offsetHeight-t.clientHeight-y-C:0,j="offsetWidth"in t?0===t.offsetWidth?0:o/t.offsetWidth:0,H="offsetHeight"in t?0===t.offsetHeight?0:n/t.offsetHeight:0;if(v===t)k="start"===s?O:"end"===s?O-g:"nearest"===s?N(b,b+g,g,y,C,b+O,b+O+w,w):O-g/2,W="start"===a?A:"center"===a?A-h/2:"end"===a?A-h:N(p,p+h,h,f,E,p+A,p+A+M,M),k=Math.max(0,k+b),W=Math.max(0,W+p);else{k="start"===s?O-r-y:"end"===s?O-u+C+R:"nearest"===s?N(r,u,n,y,C+R,O,O+w,w):O-(r+n/2)+R/2,W="start"===a?A-c-f:"center"===a?A-(c+o/2)+T/2:"end"===a?A-l+E+T:N(c,l,o,f,E+T,A,A+M,M);const{scrollLeft:e,scrollTop:i}=t;k=0===H?0:Math.max(0,Math.min(i+k/H,t.scrollHeight-n/H+R)),W=0===j?0:Math.max(0,Math.min(e+W/j,t.scrollWidth-o/j+T)),O+=i-k,A+=e-W}V.push({el:t,top:k,left:W})}return V};function I(e,t){if(!e.isConnected||!(e=>{let t=e;for(;t&&t.parentNode;){if(t.parentNode===document)return!0;t=t.parentNode instanceof ShadowRoot?t.parentNode.host:t.parentNode}return!1})(e))return;const n=(e=>{const t=window.getComputedStyle(e);return{top:parseFloat(t.scrollMarginTop)||0,right:parseFloat(t.scrollMarginRight)||0,bottom:parseFloat(t.scrollMarginBottom)||0,left:parseFloat(t.scrollMarginLeft)||0}})(e);if((e=>"object"==typeof e&&"function"==typeof e.behavior)(t))return t.behavior(M(e,t));const o="boolean"==typeof t||null==t?void 0:t.behavior;for(const{el:r,top:l,left:i}of M(e,(e=>!1===e?{block:"end",inline:"nearest"}:(e=>e===Object(e)&&0!==Object.keys(e).length)(e)?e:{block:"start",inline:"nearest"})(t))){const e=l-n.top+n.bottom,t=i-n.left+n.right;r.scroll({top:e,left:t,behavior:o})}}let S;const x=()=>(S||(S="performance"in window?performance.now.bind(performance):Date.now),S());function $(e){const t=x(),n=Math.min((t-e.startTime)/e.duration,1),o=e.ease(n),r=e.startX+(e.x-e.startX)*o,l=e.startY+(e.y-e.startY)*o;e.method(r,l,n,o),r!==e.x||l!==e.y?requestAnimationFrame((()=>$(e))):e.cb()}function k(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e=>1+--e*e*e*e*e,l=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0;const s=e,a=e.scrollLeft,u=e.scrollTop;$({scrollable:s,method:(t,n,o,r)=>{const l=Math.ceil(t),s=Math.ceil(n);e.scrollLeft=l,e.scrollTop=s,null==i||i({target:e,elapsed:o,value:r,left:l,top:s})},startTime:x(),startX:a,startY:u,x:t,y:n,duration:o,ease:r,cb:l})}const W=function(e,t){const n=t||{};return(e=>e&&!e.behavior||"smooth"===e.behavior)(n)?I(e,{block:n.block,inline:n.inline,scrollMode:n.scrollMode,boundary:n.boundary,skipOverflowHiddenElements:n.skipOverflowHiddenElements,behavior:e=>Promise.all(e.reduce(((e,t)=>{let{el:o,left:r,top:l}=t;const i=o.scrollLeft,s=o.scrollTop;return i===r&&s===l?e:[...e,new Promise((e=>k(o,r,l,n.duration,n.ease,(()=>e({el:o,left:[i,r],top:[s,l]})),n.onScrollChange)))]}),[]))}):Promise.resolve(I(e,t))},T=e=>Object.values(e).map((e=>e.current)).filter(Boolean);function R(e,t,n,o,r,l){var i;const s=(null===(i=null==e?void 0:e.entry)||void 0===i?void 0:i.target)||e;if(!s)return;const a={behavior:t||"smooth",inline:n||"end",block:o||"nearest"};return l?s.scrollIntoView(a):W(s,Object.assign(Object.assign({},r),a))}const O=e=>document.querySelector(`[${m}='${e}']`),A=e=>document.querySelector(`[${f}='${e}']`);function V(t){return e.isValidElement(t)&&t||"function"==typeof t&&e.createElement(t,null)||null}const j=e=>e.filter((e=>!new RegExp(`.*${n}$`).test(e))),H=e=>{var t;return String((null===(t=null==e?void 0:e.props)||void 0===t?void 0:t[v])||String((null==e?void 0:e.key)||"").replace(/^\.\$/,""))};function B({children:t,itemClassName:l="",refs:i,separatorClassName:s=""}){const a=e.Children.toArray(t).filter(Boolean),u=a.length,c=e.useMemo((()=>`${r} ${l}`),[l]),d=e.useMemo((()=>`${o} ${s}`),[s]);return e.createElement(e.Fragment,null,a.map(((t,o)=>{const r=H(t),l=r+n,s=o+1===u;return[e.createElement(b,{className:c,id:r,key:"menuItem__"+r,refs:i,index:o},t),!s&&e.createElement(p,{className:d,id:l,refs:i,key:l,index:o+.1})]})))}const F="undefined"!=typeof window?e.useLayoutEffect:e.useEffect;function L({items:t,itemsChanged:n,refs:o,options:r}){const l=e.useRef(),[i,s]=e.useState([]),a=e.useRef(setTimeout((()=>{}),0)),u=e.useCallback((e=>{t.set(function(e,t){return[...e].map((e=>{var n,o,r,l;const i=e.target,s=String(null!==(o=null===(n=null==i?void 0:i.dataset)||void 0===n?void 0:n.key)&&void 0!==o?o:"");return[s,{index:String(null!==(l=null===(r=null==i?void 0:i.dataset)||void 0===r?void 0:r.index)&&void 0!==l?l:""),key:s,entry:e,visible:e.intersectionRatio>=t.ratio}]}))}(e,r)),clearTimeout(a.current),a.current=P((()=>{s((e=>{const n=t.getVisible().map((e=>e[1].key));return JSON.stringify(e)!==JSON.stringify(n)?n:e}))}),r.throttle)}),[t,r]);return F((()=>{const e=T(o),t=l.current||new IntersectionObserver(u,r);return l.current=t,e.forEach((e=>t.observe(e))),()=>{clearTimeout(a.current),t.disconnect(),l.current=void 0}}),[u,n,r,o]),i}const P=(e,t=0)=>setTimeout((()=>{requestAnimationFrame(e)}),t),D=t=>e.Children.toArray(t).map(H).filter(Boolean);class _ extends Map{toArr(){return this.sort([...this])}toItems(){return this.toArr().map((([e])=>e))}toItemsWithoutSeparators(){return j(this.toItems())}toItemsKeys(){return this.toItems()}sort(e){return e.sort((([,e],[,t])=>+e.index-+t.index))}set(e,t){return Array.isArray(e)?this.sort(e).forEach((([e,t])=>{super.set(String(e),t)})):super.set(String(e),t),this}first(){var e;return null===(e=this.toArr()[0])||void 0===e?void 0:e[1]}last(){var e,t;return null===(t=null===(e=this.toArr().slice(-1))||void 0===e?void 0:e[0])||void 0===t?void 0:t[1]}filter(e){return this.toArr().filter(e)}find(e){return this.toArr().find(e)}findIndex(e){return this.toArr().findIndex(e)}getCurrentPos(e,t){const o=this.toArr().filter((e=>{var o;return t?!(null===(o=null==e?void 0:e[0])||void 0===o?void 0:o.includes(n)):e})),r=o.findIndex((([t,n])=>t===e||n===e));return[o,r]}prev(e,t){var n;const[o,r]=this.getCurrentPos(e,!!t);return-1!==r?null===(n=o[r-1])||void 0===n?void 0:n[1]:void 0}next(e,t){var n;const[o,r]=this.getCurrentPos(e,!!t);return-1!==r?null===(n=o[r+1])||void 0===n?void 0:n[1]:void 0}getVisible(){return this.filter((e=>e[1].visible))}getVisibleElements(){return this.filter((e=>!e[0].includes(n)&&e[1].visible))}}const X={ratio:.9,rootMargin:"5px",threshold:[.05,.5,.75,.95],throttle:100};const Y=e.createContext({}),q=e=>e.reduce(((e,t)=>e.concat(t).concat(`${t}${n}`)),[]).slice(0,-1);function J(e,t){const n=j(e),o=j(t);return{prev:()=>q(function(e,t){const n=e.findIndex((e=>e===(null==t?void 0:t[0]))),o=t.length,r=n-o,l=r<0,i=l?0:r,s=e.slice(i,l?o:n);return s.length===o?s:e.slice(n,o)}(n,o)),next:()=>q(function(e,t){const n=e.findIndex((e=>{var n;return e===(null===(n=t.slice(-1))||void 0===n?void 0:n[0])})),o=t.length,r=n+o+1,l=r>e.length-1,i=l?e.length-1:r,s=e.slice(l?i-o+1:n+1,i);return s.length===o?s:e.slice(e.length-o,e.length+o)}(n,o))}}const U=e=>{var t;const o=(e=>e.filter(((e,t,o)=>{const r=0===t,l=t===o.length-1,i=new RegExp(n).test(e);return!((r||l)&&i)})))(e),r=o[Math.floor(o.length/2)];return{first:null==o?void 0:o[0],center:r,last:null===(t=o.slice(-1))||void 0===t?void 0:t[0]}},z={current:{}},K=()=>{};function G({LeftArrow:t,RightArrow:o,children:r,Header:l,Footer:v,transitionDuration:m=500,transitionEase:f,transitionBehavior:h,onInit:p=K,onUpdate:b=K,onMouseDown:y,onMouseUp:w,onMouseMove:E,onScroll:N=K,onTouchMove:C,onTouchStart:M,onTouchEnd:I,onWheel:S=K,options:x=X,scrollContainerClassName:$="",itemClassName:k="",separatorClassName:W="",wrapperClassName:T="",apiRef:H=z,RTL:F,noPolyfill:P}){const q=V(t),J=V(o),U=V(l),G=V(v),Q=e.useRef(null),[Z]=e.useState({}),ee=e.useMemo((()=>Object.assign(Object.assign(Object.assign({},X),x),{root:Q.current})),[x,Q.current]),te=e.useRef(new _).current,ne=function(t,o){const[r,l]=e.useState(""),i=e.useMemo((()=>D(t)),[t]);return e.useEffect((()=>{const e=i.filter(Boolean).join("");o.toItemsWithoutSeparators().filter((e=>!i.includes(e))).forEach((e=>{var t,r;const l=(null===(t=o.last())||void 0===t?void 0:t.key)===e&&(null===(r=o.prev(e))||void 0===r?void 0:r.key)||"";o.delete(l),o.delete(`${e}${n}`),o.delete(e)})),l(e)}),[i,o]),r}(r,te),oe=L(e.useMemo((()=>({items:te,itemsChanged:ne,options:ee,refs:Z})),[te,ne,Z,ee])),re=!!oe.length,le=e.useMemo((()=>function(e,t=[],n,o){var r,l,i;const s=j(t),a=!!(null===(r=e.first())||void 0===r?void 0:r.visible),u=!!(null===(l=e.last())||void 0===l?void 0:l.visible),c=t=>{var n;return null===(n=e.find((e=>e[1].key===String(t))))||void 0===n?void 0:n[1]},d=()=>{var t,n;return e.prev(null===(n=null===(t=e.getVisible())||void 0===t?void 0:t[0])||void 0===n?void 0:n[1])},v=()=>{var t,n,o,r;return e.next(null===(r=null===(o=null===(n=null===(t=e.getVisible())||void 0===t?void 0:t.slice)||void 0===n?void 0:n.call(t,-1))||void 0===o?void 0:o[0])||void 0===r?void 0:r[1])},m=null===(i=null==n?void 0:n.boundary)||void 0===i?void 0:i.current;return{getItemById:c,getItemElementById:O,getItemByIndex:t=>{var n;return null===(n=e.find((e=>String(e[1].index)===String(t))))||void 0===n?void 0:n[1]},getItemElementByIndex:A,getNextItem:v,getNextElement:()=>{var t,n,o,r;return e.next(null===(r=null===(o=null===(n=null===(t=e.getVisibleElements())||void 0===t?void 0:t.slice)||void 0===n?void 0:n.call(t,-1))||void 0===o?void 0:o[0])||void 0===r?void 0:r[1],!0)},getPrevItem:d,getPrevElement:()=>{var t,n;return e.prev(null===(n=null===(t=e.getVisibleElements())||void 0===t?void 0:t[0])||void 0===n?void 0:n[1],!0)},isFirstItemVisible:a,isItemVisible:e=>s.includes(String(e)),isLastItem:t=>e.last()===c(t),isLastItemVisible:u,scrollNext:(e,t,r,{duration:l,ease:i,boundary:s=m}={})=>{const a=null!=e?e:null==n?void 0:n.behavior;return R(v(),a,t||"start",r||"nearest",{boundary:s,duration:null!=l?l:null==n?void 0:n.duration,ease:null!=i?i:null==n?void 0:n.ease},o)},scrollPrev:(e,t,r,{duration:l,ease:i,boundary:s=m}={})=>{const a=null!=e?e:null==n?void 0:n.behavior;return R(d(),a,t||"end",r||"nearest",{boundary:s,duration:null!=l?l:null==n?void 0:n.duration,ease:null!=i?i:null==n?void 0:n.ease},o)},scrollToItem:(e,t,r,l,i)=>{var s,a;return R(e,null!=t?t:null==n?void 0:n.behavior,r,l,Object.assign(Object.assign({boundary:m},i),{duration:null!==(s=null==i?void 0:i.duration)&&void 0!==s?s:null==n?void 0:n.duration,ease:null!==(a=null==i?void 0:i.ease)&&void 0!==a?a:null==n?void 0:n.ease}),o)},visibleElements:s,visibleElementsWithSeparators:t,visibleItems:t,visibleItemsWithoutSeparators:s}}(te,oe,{duration:m,ease:f,behavior:h,boundary:Q},P)),[te,oe,ne,F,P]),ie=e.useCallback((()=>Object.assign(Object.assign({},le),{initComplete:re,items:te,visibleElementsWithSeparators:oe,scrollContainer:Q})),[le,re,te,oe,Q]),[se,ae]=e.useState(ie);!function({cb:t=(()=>{}),condition:n,hash:o}){e.useEffect((()=>{n&&t()}),[o,n])}({cb:()=>b(se),condition:function({cb:t,condition:n}){const[o,r]=e.useState(!1);return e.useEffect((()=>{n&&!o&&(r(!0),t())}),[n,o]),o}({cb:()=>p(se),condition:re}),hash:JSON.stringify(oe.concat(String(null==se?void 0:se.isFirstItemVisible)).concat(String(null==se?void 0:se.isLastItemVisible)))}),e.useEffect((()=>ae(ie())),[ie]),H.current=se;const ue=e.useCallback((e=>N(se,e)),[N,se]),ce=e.useCallback((e=>S(se,e)),[S,se]),de=e.useMemo((()=>`${i} ${T}`),[T]),ve=e.useMemo((()=>`${$}${F?" rtl":""}`),[F,$]);return e.createElement("div",{className:de,onWheel:ce,onMouseDown:null==y?void 0:y(se),onMouseUp:null==w?void 0:w(se),onMouseMove:null==E?void 0:E(se),onTouchStart:null==M?void 0:M(se),onTouchMove:null==C?void 0:C(se),onTouchEnd:null==I?void 0:I(se)},e.createElement(Y.Provider,{value:se},e.createElement("div",{className:a},U),e.createElement("div",{className:s},e.createElement("div",{className:u},q),e.createElement(g,{className:ve,onScroll:ue,scrollRef:Q},e.createElement(B,{refs:Z,itemClassName:k,separatorClassName:W},r)),e.createElement("div",{className:c},J)),e.createElement("div",{className:d},G)))}export{G as ScrollMenu,Y as VisibilityContext,h as constants,U as getItemsPos,J as slidingWindow};
